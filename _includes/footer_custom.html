<script>
console.log('GitHub Alerts Script Loaded v2');

document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM Content Loaded - Starting Alerts processing');
  
  var alertTypes = {
    'NOTE': { icon: '\u2139\uFE0F', cls: 'alert-note', color: '#0969da' },
    'TIP': { icon: '\uD83D\uDCA1', cls: 'alert-tip', color: '#1a7f37' },
    'IMPORTANT': { icon: '\u2757', cls: 'alert-important', color: '#8250df' },
    'WARNING': { icon: '\u26A0\uFE0F', cls: 'alert-warning', color: '#9a6700' },
    'CAUTION': { icon: '\uD83D\uDED1', cls: 'alert-caution', color: '#cf222e' }
  };

  var blockquotes = document.querySelectorAll('blockquote');
  console.log('Found ' + blockquotes.length + ' blockquotes');

  for (var i = 0; i < blockquotes.length; i++) {
    var bq = blockquotes[i];
    var firstP = bq.querySelector('p');
    if (!firstP) continue;
    
    var text = firstP.innerHTML;
    // Regex matches [!TYPE] or \[!TYPE\]
    var match = text.match(/^\s*(\\?\[|&#91;)!((?:NOTE|TIP|IMPORTANT|WARNING|CAUTION))(\\?\]|&#93;)\s*/i);
    
    if (match) {
      var type = match[2].toUpperCase();
      console.log('Match found! Type: ' + type);
      var config = alertTypes[type];
      
      if (config) {
        firstP.innerHTML = text.replace(match[0], '');
        
        bq.className += ' gfm-alert ' + config.cls;
        bq.style.borderLeftColor = config.color;
        bq.style.backgroundColor = config.color + '10';
        
        var title = document.createElement('div');
        title.className = 'alert-title';
        title.innerHTML = '<span style="margin-right: 8px; font-size: 1.2em;">' + config.icon + '</span><span style="font-weight: bold; color: ' + config.color + ';">' + type.charAt(0) + type.slice(1).toLowerCase() + '</span>';
        title.style.display = 'flex';
        title.style.alignItems = 'center';
        title.style.marginBottom = '8px';
        
        bq.insertBefore(title, firstP);
      }
    }
  }
});
</script>
