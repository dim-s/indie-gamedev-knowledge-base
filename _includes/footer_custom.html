<!-- Share Floating Button (—Å–ø—Ä–∞–≤–∞) -->
<div class="share-float">
  <button class="share-float-trigger" title="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è">üì§</button>
  <div class="share-float-menu">
    <button class="share-btn share-copy" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É">üîó</button>
    <a class="share-btn share-telegram" title="Telegram" target="_blank" rel="noopener">‚úàÔ∏è</a>
    <a class="share-btn share-vk" title="VK" target="_blank" rel="noopener">üí¨</a>
    <a class="share-btn share-twitter" title="X/Twitter" target="_blank" rel="noopener">ùïè</a>
  </div>
  <div class="share-copied">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
</div>

<!-- Site Footer -->
<footer class="site-footer">
  <div class="footer-content">
    <div class="footer-license">
      <span class="footer-icon">üìú</span>
      <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">CC BY 4.0</a> ¬∑ –î–º–∏—Ç—Ä–∏–π –ó–∞–π—Ü–µ–≤, 2026
    </div>
    <div class="footer-attribution">
      –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å—Å—ã–ª–∞–π—Ç–µ—Å—å –Ω–∞ <a href="https://dim-s.github.io/indie-gamedev-knowledge-base/">—Å–∞–π—Ç</a> –∏–ª–∏ <a href="https://github.com/dim-s/indie-gamedev-knowledge-base" target="_blank" rel="noopener">—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a>
    </div>
    <div class="footer-contact">
      <span class="footer-icon">‚úâÔ∏è</span>
      <a href="mailto:d.zayceff@gmail.com">d.zayceff@gmail.com</a>
    </div>
  </div>
</footer>

<!-- Back to Top Button -->
<button class="back-to-top" aria-label="–ù–∞–≤–µ—Ä—Ö" title="–ù–∞–≤–µ—Ä—Ö">‚Üë</button>

<script>
document.addEventListener('DOMContentLoaded', function() {
  
  /* GitHub Alerts */
  var alertTypes = {
    'NOTE': { icon: '&#8505;&#65039;', cls: 'alert-note', color: '#0969da', label: '–ù–∞ –∑–∞–º–µ—Ç–∫—É' },
    'TIP': { icon: '&#128161;', cls: 'alert-tip', color: '#1a7f37', label: '–ü–æ–¥—Å–∫–∞–∑–∫–∞' },
    'IMPORTANT': { icon: '&#10071;', cls: 'alert-important', color: '#8250df', label: '–í–∞–∂–Ω–æ' },
    'WARNING': { icon: '&#9888;&#65039;', cls: 'alert-warning', color: '#9a6700', label: '–í–Ω–∏–º–∞–Ω–∏–µ' },
    'CAUTION': { icon: '&#128721;', cls: 'alert-caution', color: '#cf222e', label: '–û—Å—Ç–æ—Ä–æ–∂–Ω–æ' }
  };

  var blockquotes = document.querySelectorAll('blockquote');
  for (var i = 0; i < blockquotes.length; i++) {
    var bq = blockquotes[i];
    var firstP = bq.querySelector('p');
    if (!firstP) continue;
    
    var text = firstP.innerHTML;
    var match = text.match(/^\s*(\\?\[|&#91;)!((?:NOTE|TIP|IMPORTANT|WARNING|CAUTION))(\\?\]|&#93;)\s*/i);
    
    if (match) {
      var type = match[2].toUpperCase();
      var config = alertTypes[type];
      
      if (config) {
        firstP.innerHTML = text.replace(match[0], '');
        bq.className += ' gfm-alert ' + config.cls;
        bq.style.borderLeftColor = config.color;
        bq.style.backgroundColor = config.color + '10';
        
        var title = document.createElement('div');
        title.className = 'alert-title';
        title.innerHTML = '<span style="margin-right: 6px; font-size: 1.1em;">' + config.icon + '</span>' + 
                          '<span style="font-weight: 700; font-size: 0.9em; color: ' + config.color + ';">' + config.label + '</span>';
        title.style.display = 'flex';
        title.style.alignItems = 'center';
        title.style.marginBottom = '6px';
        title.style.lineHeight = '1.2';
        
        bq.insertBefore(title, firstP);
      }
    }
  }
  
  /* Reading Time (–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è) */
  var mainContent = document.querySelector('.main-content');
  var firstH1 = mainContent ? mainContent.querySelector('h1') : null;
  
  if (mainContent && firstH1) {
    var textContent = mainContent.textContent || mainContent.innerText;
    var wordCount = textContent.trim().split(/\s+/).length;
    var readingTime = Math.ceil(wordCount / 200); /* ~200 —Å–ª–æ–≤/–º–∏–Ω –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ */
    
    function pluralMinutes(n) {
      var abs = Math.abs(n) % 100;
      var n1 = abs % 10;
      if (abs > 10 && abs < 20) return '–º–∏–Ω—É—Ç';
      if (n1 > 1 && n1 < 5) return '–º–∏–Ω—É—Ç—ã';
      if (n1 === 1) return '–º–∏–Ω—É—Ç–∞';
      return '–º–∏–Ω—É—Ç';
    }
    
    var readingTimeEl = document.createElement('div');
    readingTimeEl.className = 'reading-time';
    readingTimeEl.innerHTML = '<span class="reading-time-icon">‚è±</span> ~' + readingTime + ' ' + pluralMinutes(readingTime) + ' —á—Ç–µ–Ω–∏—è';
    
    firstH1.parentNode.insertBefore(readingTimeEl, firstH1.nextSibling);
  }
  
  /* Share Floating Button */
  var shareFloat = document.querySelector('.share-float');
  if (shareFloat) {
    var pageUrl = encodeURIComponent(window.location.href);
    var pageTitle = encodeURIComponent(document.title);
    var trigger = shareFloat.querySelector('.share-float-trigger');
    var menu = shareFloat.querySelector('.share-float-menu');
    var copiedMsg = shareFloat.querySelector('.share-copied');
    
    var tgBtn = shareFloat.querySelector('.share-telegram');
    if (tgBtn) tgBtn.href = 'https://t.me/share/url?url=' + pageUrl + '&text=' + pageTitle;
    
    var vkBtn = shareFloat.querySelector('.share-vk');
    if (vkBtn) vkBtn.href = 'https://vk.com/share.php?url=' + pageUrl + '&title=' + pageTitle;
    
    var twBtn = shareFloat.querySelector('.share-twitter');
    if (twBtn) twBtn.href = 'https://twitter.com/intent/tweet?url=' + pageUrl + '&text=' + pageTitle;
    
    trigger.addEventListener('click', function() {
      shareFloat.classList.toggle('open');
    });
    
    var copyBtn = shareFloat.querySelector('.share-copy');
    if (copyBtn) {
      copyBtn.addEventListener('click', function() {
        navigator.clipboard.writeText(window.location.href).then(function() {
          copiedMsg.classList.add('visible');
          setTimeout(function() { copiedMsg.classList.remove('visible'); }, 1500);
        });
      });
    }
    
    document.addEventListener('click', function(e) {
      if (!shareFloat.contains(e.target)) {
        shareFloat.classList.remove('open');
      }
    });
  }
  
  /* Back to Top Button */
  var backToTopBtn = document.querySelector('.back-to-top');
  
  if (backToTopBtn) {
    var scrollThreshold = 400;
    
    function toggleBackToTop() {
      if (window.scrollY > scrollThreshold) {
        backToTopBtn.classList.add('visible');
      } else {
        backToTopBtn.classList.remove('visible');
      }
    }
    
    window.addEventListener('scroll', toggleBackToTop, { passive: true });
    
    backToTopBtn.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    toggleBackToTop();
  }
  
});
</script>
